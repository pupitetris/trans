# trans

Quick and dirty deobfuscator for JavaScript code processed with [Javascript-obfuscator](https://github.com/javascript-obfuscator/javascript-obfuscator).

```
Usage:
./trans.sh infile [cond] > outfile

       lines before cond will not be in the output, in order to remove
       the obfuscator's functions. cond could be a line number, or a
       regexp (including slashes: it's a sed address).
       Default: "1" (from the first line)
Example:
./trans.sh xcsim_1.3_enc.js '/^function *simulator *()/' > xcsim_1.3.js
```

The code is deobfuscated in three main phases:

- Call [js-beautify](https://github.com/beautify-web/js-beautify) to
  re-indent the source code and unescape strings.
- Call trans.js, a javascript program (using node.js) that extracts
  the deobfuscating functions present within the source code itself
  and run that for every invocation within the code to obtain the
  clear-text strings that replace the invocations.
- From a sed script generated by the previous phase, execute the
  string replacements and other minor deobfuscations: recover boolean
  and integer literals, recover dot notation and remove the embedded
  deobfuscator.
  
An aditional phase for manually translating the function and variable
names through a provided dictionary will be included if needed.

Dependencies: 

- GNU bash, sed, grep, coreutils (cat, cut, sort, uniq, stat, dirname, basename)
- node.js (apt install nodejs, tested with 18.13)
- js-beautify (apt install node-js-beautify, tested with 1.14)
- perl (standard with Linux installations)
